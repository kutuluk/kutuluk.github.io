webpackJsonp([0],{GBUi:function(t,e){"use strict";e.__esModule=!0;var n=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},r=function(t,e){this.c=t,this.p=null,this.n=e,this.d=0};r.prototype.r=function(){this.d=1};var i=function(){this.h=null};i.prototype.add=function(t){var e=new r(t,this.h);return this.h&&(this.h.p=e),this.h=e,e},i.prototype.i=function(t){for(var e=this.h;e;)e.d?(e.p?e.p.n=e.n:this.h=e.n,e.n&&(e.n.p=e.p)):t(e.c),e=e.n};var o=function(t){this.z=t,this.o=new i,this.t=new i};o.prototype.add=function(t){t.remove(),t.layer=this,t.n=(function(t){return 1!==t.alpha||0===t.frame.atest}(t)?this.t:this.o).add(t)};var a=function t(e,r){var i=n({antialias:!1,alpha:!1},r),a=i.alpha?1:770,u=e.getContext("webgl",i),c=u.getExtension("ANGLE_instanced_arrays"),s=function(t,e){var n=u.createShader(e);return u.shaderSource(n,t),u.compileShader(n),n},h=u.createProgram();u.attachShader(h,s("attribute vec2 g;\nattribute vec2 a;\nattribute vec2 t;\nattribute float r;\nattribute vec2 s;\nattribute vec4 u;\nattribute vec4 c;\nattribute float z;\nuniform mat4 m;\nvarying vec2 v;\nvarying vec4 i;\nvoid main(){\nv=u.xy+g*u.zw;\ni=c.abgr;\nvec2 p=(g-a)*s;\nfloat q=cos(r);\nfloat w=sin(r);\np=vec2(p.x*q-p.y*w,p.x*w+p.y*q);\np+=a+t;\ngl_Position=m*vec4(p,z,1);}",35633)),u.attachShader(h,s("precision mediump float;\nuniform sampler2D x;\nuniform float j;\nvarying vec2 v;\nvarying vec4 i;\nvoid main(){\nvec4 c=texture2D(x,v);\ngl_FragColor=c*i;\nif(j>0.0){\nif(c.a<j)discard;\ngl_FragColor.a=1.0;};}",35632)),u.linkProgram(h);var f=function(t,e,n){var r=u.createBuffer();return u.bindBuffer(t,r),u.bufferData(t,e,n||35044),r},l=function(t,e,n,r,i,o,a){var s=u.getAttribLocation(h,t);return u.enableVertexAttribArray(s),u.vertexAttribPointer(s,e,o||5126,!!a,n||0,i||0),r&&c.vertexAttribDivisorANGLE(s,r),s};f(34963,new Uint8Array([0,1,2,2,1,3])),f(34962,new Float32Array([0,0,0,1,1,0,1,1])),l("g",2);var d=new ArrayBuffer(3407820),p=new Float32Array(d),v=new Uint32Array(d);f(34962,d,35048),l("a",2,52,1),l("s",2,52,1,8),l("r",1,52,1,16),l("t",2,52,1,20),l("u",4,52,1,28),l("c",4,52,1,44,5121,!0),l("z",1,52,1,48);var y,m,g=function(t){return u.getUniformLocation(h,t)},b=g("m"),x=g("x"),w=g("j"),P=0,T=function(){P&&(u.bufferSubData(34962,0,p.subarray(0,13*P)),c.drawElementsInstancedANGLE(4,6,5121,0,P),P=0)},M=function(t){if(t.visible){65535===P&&T();var e=t.frame,n=t.scale,r=t.position,i=e.tex,o=e.size,a=e.uvs,c=t.anchor||e.anchor;y!==i&&(T(),y=i,u.bindTexture(3553,i),u.uniform1i(x,i),u.uniform1f(w,m?e.atest:0));var s=13*P;p[s++]=c.x,p[s++]=c.y,p[s++]=n.x*o.x,p[s++]=n.y*o.y,p[s++]=t.rotation,p[s++]=r.x,p[s++]=r.y,p[s++]=a[0],p[s++]=a[1],p[s++]=a[2],p[s++]=a[3],v[s++]=((16777215&t.tint)<<8|255*t.alpha&255)>>>0,p[s++]=t.layer.z,P++}},E=new o(0),_=[E],A={gl:u,camera:{at:t.Point(),to:t.Point(),angle:0},background:function(t,e,n,r){void 0===r&&(r=1),u.clearColor(t,e,n,r)},layer:function(t){var e=_.find(function(e){return e.z===t});return e||(e=new o(t),_.push(e),_.sort(function(t,e){return e.z-t.z})),e},add:function(t){E.add(t)},render:function(){var t=e.clientWidth,n=e.clientHeight;e.width=t,e.height=n;var r=A.camera,i=r.at,o=r.to,c=r.angle,s=i.x-t*o.x,f=i.y-n*o.y,l=Math.cos(c),d=Math.sin(c),p=2/t,v=-2/n,g=[l*p,d*v,0,0,-d*p,l*v,0,0,0,0,-1e-5,0,(i.x*(1-l)+i.y*d)*p-2*s/t-1,(i.y*(1-l)-i.x*d)*v+2*f/n+1,0,1];u.useProgram(h),u.uniformMatrix4fv(b,!1,g),u.viewport(0,0,t,n),u.clear(16640),u.activeTexture(33984),y=null,u.disable(3042),u.enable(2929),u.depthFunc(513),m=!0,_.forEach(function(t){return t.o.i(function(t){return M(t)})}),T(),u.enable(3042),u.blendFunc(a,771),u.depthFunc(515),u.uniform1f(w,0),m=!1;for(var x=_.length-1;x>=0;x--)_[x].t.i(function(t){return M(t)});T()}};return A.render(),A};a.Point=function(){function t(t,e){if(!(this instanceof a.Point))return new a.Point(t,e);this.set(t,e)}return t.prototype.set=function(t,e){return this.x=t||0,this.y=e||(0!==e?this.x:0),this},t.prototype.copy=function(t){return this.x=t.x,this.y=t.y,this},t}();var u=function t(e,n,r,i){if(!(this instanceof t))return new t(e,n,r,i);this.size=a.Point().copy(r),this.anchor=a.Point().copy(i||e.anchor),this.uvs=[n.x/e.size.x,n.y/e.size.y,r.x/e.size.x,r.y/e.size.y],this.t=e},c={atest:{configurable:!0},tex:{configurable:!0}};c.atest.get=function(){return this.t.atest},c.tex.get=function(){return this.t.tex},Object.defineProperties(u.prototype,c),a.Frame=u,a.Texture=function t(e,r,i,o){if(!(this instanceof t))return new t(e,r,i,o);this.size=a.Point(r.width,r.height),this.anchor=a.Point(),this.uvs=[0,0,1,1],this.atest=i||(0===i?0:1);var u=n({10240:9728,10241:9728,10242:33071,10243:33071},o),c=e.gl;this.tex=c.createTexture(),c.bindTexture(3553,this.tex),Object.keys(u).forEach(function(t){return c.texParameteri(3553,t,u[t])}),c.texImage2D(3553,0,6408,6408,5121,r)},a.Sprite=function(){function t(e,r){if(!(this instanceof t))return new t(e,r);this.frame=e,this.a=1,n(this,{visible:!0,position:a.Point(),rotation:0,anchor:null,scale:a.Point(1),tint:16777215},r),this.remove()}var e={alpha:{configurable:!0}};return e.alpha.get=function(){return this.a},e.alpha.set=function(t){var e=this.a;this.a=t,this.n&&(t<1&&1===e||1===t&&e<1)&&this.layer.add(this)},t.prototype.remove=function(){this.n&&this.n.r(),this.layer=null,this.n=null},Object.defineProperties(t.prototype,e),t}(),e.default=a},ZAL5:function(t){t.exports={home:"home__2Q5nZ"}},"iOg+":function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}function i(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function o(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}e.__esModule=!0,e.default=void 0;var a=n("KM04"),u=n("GBUi"),c=r(u),s=n("ZAL5"),h=r(s),f=c.default.Point,l=c.default.Texture,d=c.default.Frame,p=c.default.Sprite,v=function(){var t=document.createElement("canvas");t.width=96,t.height=32;var e=t.getContext("2d"),n=0;e.lineWidth=2,e.fillStyle="#cccccc",e.strokeStyle="#000000",e.beginPath(),e.moveTo(n+16,16);for(var r=0;r<2*Math.PI;r+=2*Math.PI/5)e.lineTo(n+16-16*Math.sin(r)*.9,16-16*Math.cos(r)*.9);return e.closePath(),e.fill(),e.stroke(),n+=32,e.beginPath(),e.moveTo(n+3,3),e.lineTo(n+32-3,3),e.lineTo(n+32-3,29),e.lineTo(n+3,29),e.closePath(),e.fill(),e.stroke(),n+=32,e.beginPath(),e.moveTo(n+3,3),e.lineTo(n+29,3),e.lineTo(n+29,8),e.lineTo(n+8,8),e.lineTo(n+8,14),e.lineTo(n+20,14),e.lineTo(n+20,18),e.lineTo(n+8,18),e.lineTo(n+8,29),e.lineTo(n+3,29),e.closePath(),e.fill(),e.stroke(),t},y=(0,a.h)("canvas",{id:"view"});e.default=function(t){function e(){for(var e,n,r,o=arguments.length,a=Array(o),u=0;u<o;u++)a[u]=arguments[u];return e=n=i(this,t.call.apply(t,[this].concat(a))),n.onmousedown=function(t){n.add=!0,t.preventDefault()},n.ontouchstart=function(t){n.add=!0,t.preventDefault()},n.onmouseup=function(t){n.add=!1,t.preventDefault()},n.ontouchend=function(t){n.add=!1,t.preventDefault()},r=e,i(n,r)}return o(e,t),e.prototype.componentDidMount=function(){var t,e=this,n=document.getElementById("view");this.add=!1;var r=(0,c.default)(n),i=r.gl,o=Math.min(r.gl.canvas.width,r.gl.canvas.height);r.background(1,1,1,0),r.camera.at.set(o/2,o/2),r.camera.to.set(.5);var a=l(r,v(),.5,(t={},t[i.TEXTURE_MAG_FILTER]=i.LINEAR,t[i.TEXTURE_MIN_FILTER]=i.LINEAR,t));a.anchor=f(.5);var u=d(a,f(),f(32)),s=d(a,f(32,0),f(32)),h=d(a,f(64,0),f(32)),y=[a,u,s,h],m=function(){var t=document.createElement("canvas");t.width=o,t.height=o;var e=t.getContext("2d");e.fillStyle="#ffffff",e.beginPath(),e.moveTo(o/2,o/2);for(var n=0;n<2*Math.PI;n+=2*Math.PI/5)e.lineTo(o/2-Math.sin(n)*o/2.5,o/2-Math.cos(n)*o/2.5);e.closePath(),e.fill();var r=e.getImageData(0,0,o,o),i=r.data;return function(t,e){return i[4*(e*o+t)]>0}}(),g=[],b=0,x=0,w=function(t){b%250==0&&x++,b+=t;for(var e=r.layer(x),n=0;n<t;n++){for(var i=p(y[n%4]),a=0,u=0;!m(a,u);)a=~~(o*Math.random()),u=~~(o*Math.random());i.position.set(a,u),i.scale.set(o/1200),i.tint=16777215*Math.random(),i.rotation=Math.random()*Math.PI*2,i.dr=.1*(.5-Math.random()),i.trans=!Math.round(Math.random()),g.push(i),e.add(i)}};this.props.start(function(){return(b<3e3||e.add)&&w(25),g.forEach(function(t){t.dr&&(t.rotation+=t.dr),t.trans&&(t.alpha>.8?t.alpha-=.001:t.trans=!1)}),r.camera.angle+=.005,r.render(),[{title:"sprites",value:b<1e4?b:Number((b/1e3).toFixed(1))+"k"}]})},e.prototype.render=function(){return(0,a.h)("div",{class:h.default.home,onMouseDown:this.onmousedown,onTouchStart:this.ontouchstart,onMouseUp:this.onmouseup,onTouchEnd:this.ontouchend},"Click or touch to add sprites",y)},e}(a.Component)}});
//# sourceMappingURL=route-home.chunk.5626e.js.map