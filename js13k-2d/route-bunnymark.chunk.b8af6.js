webpackJsonp([1],{GBUi:function(t,e){"use strict";e.__esModule=!0;var n=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])}return t},i=function(t,e,n){this.l=t,this.c=e,this.n=n,this.p=null};i.prototype.r=function(){this.p?this.p.n=this.n:this.l.h=this.n,this.n&&(this.n.p=this.p)};var r=function(){this.h=null};r.prototype.add=function(t){var e=new i(this,t,this.h);return this.h&&(this.h.p=e),this.h=e,e},r.prototype.i=function(t){for(var e=this.h;e;)t(e.c),e=e.n};var o=function(t){this.z=t,this.o=new r,this.t=new r};o.prototype.add=function(t){t.remove(),t.layer=this,t.n=(function(t){return 1!==t.alpha||0===t.frame.atest}(t)?this.t:this.o).add(t)};var a=function t(e,i){var r=n({antialias:!1,alpha:!1,scale:1},i),a=r.alpha?1:770,s=r.scale,u=e.getContext("webgl",r),c=u.getExtension("ANGLE_instanced_arrays"),h=function(t,e){var n=u.createShader(e);return u.shaderSource(n,t),u.compileShader(n),n},f=u.createProgram();u.attachShader(f,h("attribute vec2 g;\nattribute vec2 a;\nattribute vec2 t;\nattribute float r;\nattribute vec2 s;\nattribute vec4 u;\nattribute vec4 c;\nattribute float z;\nuniform mat4 m;\nvarying vec2 v;\nvarying vec4 i;\nvoid main(){\nv=u.xy+g*u.zw;\ni=c.abgr;\nvec2 p=(g-a)*s;\nfloat q=cos(r);\nfloat w=sin(r);\np=vec2(p.x*q-p.y*w,p.x*w+p.y*q);\np+=a+t;\ngl_Position=m*vec4(p,z,1);}",35633)),u.attachShader(f,h("precision mediump float;\nuniform sampler2D x;\nuniform float j;\nvarying vec2 v;\nvarying vec4 i;\nvoid main(){\nvec4 c=texture2D(x,v);\ngl_FragColor=c*i;\nif(j>0.0){\nif(c.a<j)discard;\ngl_FragColor.a=1.0;};}",35632)),u.linkProgram(f);var l=function(t,e,n){var i=u.createBuffer();u.bindBuffer(t,i),u.bufferData(t,e,n||35044)},p=function(t,e,n,i,r,o,a){var s=u.getAttribLocation(f,t);u.enableVertexAttribArray(s),u.vertexAttribPointer(s,e,o||5126,!!a,n||0,r||0),i&&c.vertexAttribDivisorANGLE(s,i)};l(34963,new Uint8Array([0,1,2,2,1,3])),l(34962,new Float32Array([0,0,0,1,1,0,1,1])),p("g",2);var d=new ArrayBuffer(3407820),v=new Float32Array(d),y=new Uint32Array(d);l(34962,d,35048),p("a",2,52,1),p("s",2,52,1,8),p("r",1,52,1,16),p("t",2,52,1,20),p("u",4,52,1,28),p("c",4,52,1,44,5121,!0),p("z",1,52,1,48);var m,x,g,b,w,P=function(t){return u.getUniformLocation(f,t)},M=P("m"),E=P("x"),_=P("j"),z=0,A=function(){return g=e.clientHeight*s|0,(e.width!==(x=e.clientWidth*s|0)||e.height!==g)&&(e.width=x,e.height=g,!0)},T=function(){z&&(u.blendFunc(w?1:a,w?0:771),u.depthFunc(w?513:515),u.bindTexture(3553,b.tex),u.uniform1i(E,b.tex),u.uniform1f(_,w?b.atest:0),u.bufferSubData(34962,0,v.subarray(0,13*z)),c.drawElementsInstancedANGLE(4,6,5121,0,z),z=0)},j=function(t){if(t.visible){65535===z&&T();var e=t.frame,n=e.uvs,i=t.anchor||e.anchor;b.tex!==e.tex&&(b.tex&&T(),b=e);var r=13*z;v[r++]=i.x,v[r++]=i.y,v[r++]=t.scale.x*e.size.x,v[r++]=t.scale.y*e.size.y,v[r++]=t.rotation,v[r++]=t.position.x,v[r++]=t.position.y,v[r++]=n[0],v[r++]=n[1],v[r++]=n[2],v[r++]=n[3],y[r++]=((16777215&t.tint)<<8|255*t.alpha&255)>>>0,v[r++]=t.layer.z,z++}},D=new o(0),S=[D],F={gl:u,camera:{at:t.Point(),to:t.Point(),angle:0},background:function(t,e,n,i){void 0===i&&(i=1),u.clearColor(t,e,n,i)},layer:function(t){var e=S.find(function(e){return e.z===t});return e||(e=new o(t),S.push(e),S.sort(function(t,e){return e.z-t.z})),e},add:function(t){D.add(t)},resize:A,render:function(){A();var t=F.camera,e=t.at,n=t.to,i=t.angle,r=e.x-x*n.x,o=e.y-g*n.y,a=Math.cos(i),s=Math.sin(i),c=2/x,h=-2/g;m=[a*c,s*h,0,0,-s*c,a*h,0,0,0,0,-1e-5,0,(e.x*(1-a)+e.y*s)*c-2*r/x-1,(e.y*(1-a)-e.x*s)*h+2*o/g+1,0,1],u.useProgram(f),u.enable(3042),u.enable(2929),u.uniformMatrix4fv(M,!1,m),u.viewport(0,0,x,g),u.clear(16640),b={tex:null},w=!0,S.forEach(function(t){return t.o.i(function(t){return j(t)})}),T(),w=!1;for(var l=S.length-1;l>=0;l--)S[l].t.i(function(t){return j(t)});T()}};return A(),F};a.Point=function(){function t(t,e){if(!(this instanceof a.Point))return new a.Point(t,e);this.set(t,e)}return t.prototype.set=function(t,e){return this.x=t||0,this.y=e||(0!==e?this.x:0),this},t.prototype.copy=function(t){return this.x=t.x,this.y=t.y,this},t}();var s=function t(e,n,i,r){if(!(this instanceof t))return new t(e,n,i,r);this.size=a.Point().copy(i),this.anchor=a.Point().copy(r||e.anchor),this.uvs=[n.x/e.size.x,n.y/e.size.y,i.x/e.size.x,i.y/e.size.y],this.t=e},u={atest:{configurable:!0},tex:{configurable:!0}};u.atest.get=function(){return this.t.atest},u.tex.get=function(){return this.t.tex},Object.defineProperties(s.prototype,u),a.Frame=s,a.Texture=function t(e,i,r,o){if(!(this instanceof t))return new t(e,i,r,o);this.size=a.Point(i.width,i.height),this.anchor=a.Point(),this.uvs=[0,0,1,1],this.atest=r||(0===r?0:1);var s=n({10240:9728,10241:9728,10242:33071,10243:33071},o),u=e.gl;this.tex=u.createTexture(),u.bindTexture(3553,this.tex),Object.keys(s).forEach(function(t){return u.texParameteri(3553,t,s[t])}),u.texImage2D(3553,0,6408,6408,5121,i)},a.Sprite=function(){function t(e,i){if(!(this instanceof t))return new t(e,i);n(this,{frame:e,visible:!0,position:a.Point(),rotation:0,anchor:null,scale:a.Point(1),tint:16777215,a:1},i),this.remove()}var e={alpha:{configurable:!0}};return e.alpha.get=function(){return this.a},e.alpha.set=function(t){var e=this.a;this.a=t,this.n&&(t<1&&1===e||1===t&&e<1)&&this.layer.add(this)},t.prototype.remove=function(){this.n&&this.n.r(),this.layer=null,this.n=null},Object.defineProperties(t.prototype,e),t}(),e.default=a},WUy4:function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}function r(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function o(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}e.__esModule=!0,e.default=void 0;var a=n("KM04"),s=n("GBUi"),u=i(s),c=n("a39o"),h=i(c),f=u.default.Point,l=u.default.Texture,p=u.default.Frame,d=u.default.Sprite,v=16777215*Math.random(),y=function(){var t=document.createElement("canvas");t.width=32,t.height=32;var e=t.getContext("2d");e.lineWidth=2,e.fillStyle="#cccccc",e.strokeStyle="#000000",e.beginPath(),e.moveTo(16,16);for(var n=0;n<2*Math.PI;n+=2*Math.PI/5)e.lineTo(16-16*Math.sin(n)*.9,16-16*Math.cos(n)*.9);return e.closePath(),e.fill(),e.stroke(),t},m=function(t){function e(e,n){var i=r(this,t.call(this,e,n));return i.gravity=.75,i.speedX=4*Math.random(),i.speedY=4*Math.random()-2,i}return o(e,t),e.prototype.update=function(t){this.position.x+=this.speedX,this.position.y+=this.speedY,this.speedY+=this.gravity,this.position.x>t.right?(this.speedX*=-1,this.position.x=t.right):this.position.x<t.left&&(this.speedX*=-1,this.position.x=t.left),this.position.y>t.bottom?(this.speedY*=-.85,this.position.y=t.bottom,Math.random()>.5&&(this.speedY-=6*Math.random())):this.position.y<t.top&&(this.speedY=0,this.position.y=t.top)},e}(d),x=(0,a.h)("canvas",{id:"view"});e.default=function(t){function e(){for(var e,n,i,o=arguments.length,a=Array(o),s=0;s<o;s++)a[s]=arguments[s];return e=n=r(this,t.call.apply(t,[this].concat(a))),n.onmousedown=function(t){n.add=!0,v=16777215*Math.random(),t.preventDefault()},n.ontouchstart=function(t){n.add=!0,v=16777215*Math.random(),t.preventDefault()},n.onmouseup=function(t){n.add=!1,t.preventDefault()},n.ontouchend=function(t){n.add=!1,t.preventDefault()},i=e,r(n,i)}return o(e,t),e.prototype.componentDidMount=function(){var t,e=this,n=document.getElementById("view");this.add=!1;var i=1===window.devicePixelRatio?1:2,r=(0,u.default)(n,{scale:i}),o=r.gl;r.background(1,1,1);var a=l(r,y(),.5,(t={},t[o.TEXTURE_MAG_FILTER]=o.LINEAR,t[o.TEXTURE_MIN_FILTER]=o.LINEAR,t));a.anchor=f(.5);var s=[p(a,f(),f(32))],c=0,h=0,d=[],x=function(t){c%250==0&&h++,c+=t;for(var e=r.layer(h),i=n.width,o=0;o<t;o++){var a=new m(s[o%s.length],{position:f(o%2*i,0),tint:v});e.add(a),d.push(a)}};this.props.start(function(){r.resize(),(c<3e3||e.add)&&x(25);var t={left:0,top:0,right:n.width,bottom:n.height};return d.forEach(function(e){return e.update(t)}),r.render(),[{title:"sprites",value:c<1e4?c:Number((c/1e3).toFixed(1))+"k"}]})},e.prototype.render=function(){return(0,a.h)("div",{class:h.default.home,onMouseDown:this.onmousedown,onTouchStart:this.ontouchstart,onMouseUp:this.onmouseup,onTouchEnd:this.ontouchend},"Click or touch to add sprites",x)},e}(a.Component)},a39o:function(t){t.exports={home:"home__lijWV"}}});
//# sourceMappingURL=route-bunnymark.chunk.b8af6.js.map