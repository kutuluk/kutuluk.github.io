{"version":3,"sources":["webpack:///route-home.chunk.fb2b2.js","webpack:///./routes/home/index.js","webpack:///../node_modules/js13k-2d/dist/renderer.m.js","webpack:///./routes/home/style.css"],"names":["webpackJsonp","75T4","module","exports","__webpack_require__","_interopRequireDefault","obj","__esModule","default","_possibleConstructorReturn","self","call","ReferenceError","_inherits","subClass","superClass","TypeError","prototype","Object","create","constructor","value","enumerable","writable","configurable","setPrototypeOf","__proto__","undefined","_preact","_js13k2d","_js13k2d2","_style","_style2","Point","Renderer","Texture","Frame","Sprite","atlasImg","canvas","document","createElement","width","height","ctx","getContext","offset","lineWidth","size","fillStyle","strokeStyle","beginPath","moveTo","angle","Math","PI","lineTo","sin","cos","closePath","fill","stroke","_ref","h","id","_Component","Home","_temp","_this","_ret","_len","arguments","length","args","Array","_key","this","apply","concat","onmousedown","event","add","preventDefault","ontouchstart","onmouseup","ontouchend","componentDidMount","_Texture","_this2","view","getElementById","scene","gl","maskSize","min","background","camera","at","set","to","atlas","TEXTURE_MAG_FILTER","LINEAR","TEXTURE_MIN_FILTER","anchor","bFrame","qFrame","fFrame","frames","mask","_ctx$getImageData","getImageData","data","x","y","sprs","len","cl","addSprite","a","layer","i","sprite","random","position","scale","tint","rotation","dr","trans","round","push","props","start","forEach","alpha","render","title","toFixed","class","style","home","onMouseDown","onTouchStart","onMouseUp","onTouchEnd","Component","GBUi","_extends","assign","target","source","key","hasOwnProperty","t","n","c","p","d","r","e","z","o","remove","frame","atest","antialias","s","getExtension","u","createShader","shaderSource","compileShader","createProgram","attachShader","linkProgram","createBuffer","bindBuffer","bufferData","f","getAttribLocation","enableVertexAttribArray","vertexAttribPointer","vertexAttribDivisorANGLE","Uint8Array","Float32Array","l","ArrayBuffer","v","Uint32Array","getUniformLocation","g","b","m","w","P","bufferSubData","subarray","drawElementsInstancedANGLE","visible","tex","uvs","bindTexture","uniform1i","uniform1f","A","j","F","clearColor","find","sort","clientWidth","clientHeight","useProgram","uniformMatrix4fv","viewport","clear","activeTexture","disable","enable","depthFunc","blendFunc","copy","get","defineProperties","10240","10241","10242","10243","createTexture","keys","texParameteri","texImage2D","ZAL5"],"mappings":"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","file":"route-home.chunk.fb2b2.js","sourcesContent":["webpackJsonp([0],{\n\n/***/ \"75T4\":\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nexports.__esModule = true;\nexports.default = undefined;\n\nvar _preact = __webpack_require__(\"KM04\");\n\nvar _js13k2d = __webpack_require__(\"GBUi\");\n\nvar _js13k2d2 = _interopRequireDefault(_js13k2d);\n\nvar _style = __webpack_require__(\"ZAL5\");\n\nvar _style2 = _interopRequireDefault(_style);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; } /* eslint-disable new-cap */\n\n\nvar Point = _js13k2d2.default.Point,\n    Texture = _js13k2d2.default.Texture,\n    Frame = _js13k2d2.default.Frame,\n    Sprite = _js13k2d2.default.Sprite;\n\n/*\nconst sprites = document.getElementById('info');\n\nconst dbgRenderInfo = gl.getExtension('WEBGL_debug_renderer_info');\nconst info = gl.getParameter(\n    dbgRenderInfo ? dbgRenderInfo.UNMASKED_RENDERER_WEBGL : gl.VENDOR\n);\n*/\n\nvar atlasImg = function atlasImg() {\n    var canvas = document.createElement('canvas');\n    var size = 32;\n    var half = size / 2;\n    canvas.width = 96;\n    canvas.height = 32;\n    var ctx = canvas.getContext('2d');\n\n    var offset = 0;\n\n    ctx.lineWidth = size / 16;\n    ctx.fillStyle = '#cccccc';\n    ctx.strokeStyle = '#000000';\n    ctx.beginPath();\n\n    ctx.moveTo(offset + half, half);\n    for (var angle = 0; angle < Math.PI * 2; angle += Math.PI * 2 / 5) {\n        ctx.lineTo(offset + half - Math.sin(angle) * half * 0.9, half - Math.cos(angle) * half * 0.9);\n    }\n\n    ctx.closePath();\n    ctx.fill();\n    ctx.stroke();\n\n    offset += size;\n\n    ctx.beginPath();\n\n    ctx.moveTo(offset + 3, 3);\n    ctx.lineTo(offset + size - 3, 3);\n    ctx.lineTo(offset + size - 3, size - 3);\n    ctx.lineTo(offset + 3, size - 3);\n\n    ctx.closePath();\n    ctx.fill();\n    ctx.stroke();\n\n    offset += size;\n\n    ctx.beginPath();\n\n    ctx.moveTo(offset + 3, 3);\n    ctx.lineTo(offset + 29, 3);\n    ctx.lineTo(offset + 29, 8);\n    ctx.lineTo(offset + 8, 8);\n    ctx.lineTo(offset + 8, 14);\n    ctx.lineTo(offset + 20, 14);\n    ctx.lineTo(offset + 20, 18);\n    ctx.lineTo(offset + 8, 18);\n    ctx.lineTo(offset + 8, 29);\n    ctx.lineTo(offset + 3, 29);\n\n    ctx.closePath();\n    ctx.fill();\n    ctx.stroke();\n\n    return canvas;\n};\n\nvar _ref = (0, _preact.h)('canvas', { id: 'view' });\n\nvar Home = function (_Component) {\n    _inherits(Home, _Component);\n\n    function Home() {\n        var _temp, _this, _ret;\n\n        _classCallCheck(this, Home);\n\n        for (var _len = arguments.length, args = Array(_len), _key = 0; _key < _len; _key++) {\n            args[_key] = arguments[_key];\n        }\n\n        return _ret = (_temp = (_this = _possibleConstructorReturn(this, _Component.call.apply(_Component, [this].concat(args))), _this), _this.onmousedown = function (event) {\n            _this.add = true;\n            event.preventDefault();\n        }, _this.ontouchstart = function (event) {\n            _this.add = true;\n            event.preventDefault();\n        }, _this.onmouseup = function (event) {\n            _this.add = false;\n            event.preventDefault();\n        }, _this.ontouchend = function (event) {\n            _this.add = false;\n            event.preventDefault();\n        }, _temp), _possibleConstructorReturn(_this, _ret);\n    }\n\n    Home.prototype.componentDidMount = function componentDidMount() {\n        var _Texture,\n            _this2 = this;\n\n        var view = document.getElementById('view');\n\n        this.add = false;\n\n        /*\n        let add = false;\n        view.onmousedown = event => {\n            event.preventDefault();\n            add = true;\n        };\n        view.ontouchstart = event => {\n            add = true;\n            event.preventDefault();\n        };\n        view.onmouseup = event => {\n            add = false;\n            event.preventDefault();\n        };\n        view.ontouchend = event => {\n            add = false;\n            event.preventDefault();\n        };\n        */\n\n        var scene = (0, _js13k2d2.default)(view);\n        var gl = scene.gl;\n\n\n        var maskSize = Math.min(scene.gl.canvas.width, scene.gl.canvas.height);\n\n        scene.background(1, 1, 1, 0);\n        scene.camera.at.set(maskSize / 2, maskSize / 2);\n        scene.camera.to.set(0.5);\n\n        var logoMask = function logoMask() {\n            var canvas = document.createElement('canvas');\n            canvas.width = maskSize;\n            canvas.height = maskSize;\n            var ctx = canvas.getContext('2d');\n\n            ctx.fillStyle = '#ffffff';\n            ctx.beginPath();\n\n            ctx.moveTo(maskSize / 2, maskSize / 2);\n            for (var angle = 0; angle < Math.PI * 2; angle += Math.PI * 2 / 5) {\n                ctx.lineTo(maskSize / 2 - Math.sin(angle) * maskSize / 2.5, maskSize / 2 - Math.cos(angle) * maskSize / 2.5);\n            }\n\n            ctx.closePath();\n            ctx.fill();\n\n            var _ctx$getImageData = ctx.getImageData(0, 0, maskSize, maskSize),\n                data = _ctx$getImageData.data;\n\n            return function (x, y) {\n                return data[(y * maskSize + x) * 4] > 0;\n            };\n        };\n\n        /*\n        const logo = () => {\n            const canvas = document.createElement('canvas');\n            canvas.width = 64;\n            canvas.height = 64;\n            const ctx = canvas.getContext('2d');\n             ctx.lineWidth = 0;\n            ctx.strokeStyle = '#3066a9';\n            ctx.fillStyle = '#3066a9';\n            ctx.beginPath();\n             ctx.moveTo(32, 32);\n            for (\n                let angle = 0;\n                angle < Math.PI * 2;\n                angle += (Math.PI * 2) / 5\n            ) {\n                ctx.lineTo(\n                    32 - Math.sin(angle) * 30,\n                    32 - Math.cos(angle) * 30\n                );\n            }\n             ctx.closePath();\n            ctx.stroke();\n            ctx.fill();\n             const image = new Image();\n            image.src = canvas.toDataURL('image/png');\n            document.body.appendChild(image);\n        };\n         logo();\n        */\n\n        var atlas = Texture(scene, atlasImg(), 0.5, (_Texture = {}, _Texture[gl.TEXTURE_MAG_FILTER] = gl.LINEAR, _Texture[gl.TEXTURE_MIN_FILTER] = gl.LINEAR, _Texture));\n        atlas.anchor = Point(0.5);\n\n        var bFrame = Frame(atlas, Point(), Point(32));\n        var qFrame = Frame(atlas, Point(32, 0), Point(32));\n        var fFrame = Frame(atlas, Point(64, 0), Point(32));\n        var frames = [atlas, bFrame, qFrame, fFrame];\n\n        var mask = logoMask();\n        var sprs = [];\n\n        var len = 0;\n        var cl = 0;\n\n        var addSprite = function addSprite(a) {\n            if (len % 250 === 0) {\n                cl++;\n            }\n            len += a;\n\n            var layer = scene.layer(cl);\n\n            for (var i = 0; i < a; i++) {\n                var sprite = Sprite(frames[i % 4]);\n\n                var x = 0;\n                var y = 0;\n\n                while (!mask(x, y)) {\n                    x = ~~(maskSize * Math.random());\n                    y = ~~(maskSize * Math.random());\n                }\n\n                sprite.position.set(x, y);\n                sprite.scale.set(maskSize / 1200);\n                sprite.tint = Math.random() * 0xffffff;\n                sprite.rotation = Math.random() * Math.PI * 2;\n                sprite.dr = (0.5 - Math.random()) * 0.1;\n                sprite.trans = !Math.round(Math.random());\n                // sprite.trans = false;\n                sprs.push(sprite);\n                layer.add(sprite);\n            }\n        };\n\n        var loop = function loop() {\n            if (len < 3000 || _this2.add) addSprite(25);\n\n            // sprites.innerHTML = `Renderer: ${info}</br>Sprites: ${len} (click to add)`;\n\n            sprs.forEach(function (sprite) {\n                sprite.dr && (sprite.rotation += sprite.dr);\n                if (sprite.trans) {\n                    if (sprite.alpha > 0.8) {\n                        sprite.alpha -= 0.001;\n                    } else {\n                        sprite.trans = false;\n                    }\n                }\n            });\n\n            scene.camera.angle += 0.005;\n\n            scene.render();\n\n            return [{\n                title: 'sprites',\n                value: len < 10000 ? len : (len / 1000).toFixed(1) + 'k'\n            }];\n        };\n\n        this.props.start(loop);\n    };\n\n    /*\n                <h1>Home</h1>\n                <p>This is the Home component.</p>\n    */\n\n    Home.prototype.render = function render() {\n        return (0, _preact.h)(\n            'div',\n            {\n                'class': _style2.default.home,\n                onMouseDown: this.onmousedown,\n                onTouchStart: this.ontouchstart,\n                onMouseUp: this.onmouseup,\n                onTouchEnd: this.ontouchend\n            },\n            'Click or touch to add sprites',\n            _ref\n        );\n    };\n\n    return Home;\n}(_preact.Component);\n\nexports.default = Home;\n\n/***/ }),\n\n/***/ \"GBUi\":\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nexports.__esModule = true;\n\nvar _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; };\n\nvar t = function t(_t, n) {\n  this.c = _t, this.p = null, this.n = n, this.d = 0;\n};t.prototype.r = function () {\n  this.d = 1;\n};var n = function n() {\n  this.h = null;\n};n.prototype.add = function (n) {\n  var e = new t(n, this.h);return this.h && (this.h.p = e), this.h = e, e;\n}, n.prototype.i = function (t) {\n  for (var n = this.h; n;) {\n    n.d ? (n.p ? n.p.n = n.n : this.h = n.n, n.n && (n.n.p = n.p)) : t(n.c), n = n.n;\n  }\n};var e = function e(t) {\n  this.z = t, this.o = new n(), this.t = new n();\n};e.prototype.add = function (t) {\n  t.remove(), t.layer = this, t.n = (function (t) {\n    return 1 !== t.alpha || 0 === t.frame.atest;\n  }(t) ? this.t : this.o).add(t);\n};var i = function i(t, n) {\n  var r = _extends({ antialias: !1, alpha: !1 }, n),\n      a = r.alpha ? 1 : 770,\n      o = t.getContext(\"webgl\", r),\n      s = o.getExtension(\"ANGLE_instanced_arrays\"),\n      u = function u(t, n) {\n    var e = o.createShader(n);return o.shaderSource(e, t), o.compileShader(e), e;\n  },\n      c = o.createProgram();o.attachShader(c, u(\"attribute vec2 g;\\nattribute vec2 a;\\nattribute vec2 t;\\nattribute float r;\\nattribute vec2 s;\\nattribute vec4 u;\\nattribute vec4 c;\\nattribute float z;\\nuniform mat4 m;\\nvarying vec2 v;\\nvarying vec4 i;\\nvoid main(){\\nv=u.xy+g*u.zw;\\ni=c.abgr;\\nvec2 p=(g-a)*s;\\nfloat q=cos(r);\\nfloat w=sin(r);\\np=vec2(p.x*q-p.y*w,p.x*w+p.y*q);\\np+=a+t;\\ngl_Position=m*vec4(p,z,1);}\", 35633)), o.attachShader(c, u(\"precision mediump float;\\nuniform sampler2D x;\\nuniform float j;\\nvarying vec2 v;\\nvarying vec4 i;\\nvoid main(){\\nvec4 c=texture2D(x,v);\\ngl_FragColor=c*i;\\nif(j>0.0){\\nif(c.a<j)discard;\\ngl_FragColor.a=1.0;};}\", 35632)), o.linkProgram(c);var h = function h(t, n, e) {\n    var i = o.createBuffer();return o.bindBuffer(t, i), o.bufferData(t, n, e || 35044), i;\n  },\n      f = function f(t, n, e, i, r, a, u) {\n    var h = o.getAttribLocation(c, t);return o.enableVertexAttribArray(h), o.vertexAttribPointer(h, n, a || 5126, !!u, e || 0, r || 0), i && s.vertexAttribDivisorANGLE(h, i), h;\n  };h(34963, new Uint8Array([0, 1, 2, 2, 1, 3])), h(34962, new Float32Array([0, 0, 0, 1, 1, 0, 1, 1])), f(\"g\", 2);var l = new ArrayBuffer(3407820),\n      v = new Float32Array(l),\n      p = new Uint32Array(l);h(34962, l, 35048), f(\"a\", 2, 52, 1), f(\"s\", 2, 52, 1, 8), f(\"r\", 1, 52, 1, 16), f(\"t\", 2, 52, 1, 20), f(\"u\", 4, 52, 1, 28), f(\"c\", 4, 52, 1, 44, 5121, !0), f(\"z\", 1, 52, 1, 48);var y,\n      d,\n      x = function x(t) {\n    return o.getUniformLocation(c, t);\n  },\n      g = x(\"m\"),\n      b = x(\"x\"),\n      m = x(\"j\"),\n      w = 0,\n      P = function P() {\n    w && (o.bufferSubData(34962, 0, v.subarray(0, 13 * w)), s.drawElementsInstancedANGLE(4, 6, 5121, 0, w), w = 0);\n  },\n      z = function z(t) {\n    if (t.visible) {\n      65535 === w && P();var n = t.frame,\n          e = t.scale,\n          i = t.position,\n          r = n.tex,\n          a = n.size,\n          s = n.uvs,\n          u = t.anchor || n.anchor;y !== r && (P(), y = r, o.bindTexture(3553, r), o.uniform1i(b, r), o.uniform1f(m, d ? n.atest : 0));var c = 13 * w;v[c++] = u.x, v[c++] = u.y, v[c++] = e.x * a.x, v[c++] = e.y * a.y, v[c++] = t.rotation, v[c++] = i.x, v[c++] = i.y, v[c++] = s[0], v[c++] = s[1], v[c++] = s[2], v[c++] = s[3], p[c++] = ((16777215 & t.tint) << 8 | 255 * t.alpha & 255) >>> 0, v[c++] = t.layer.z, w++;\n    }\n  },\n      A = new e(0),\n      j = [A],\n      F = { gl: o, camera: { at: i.Point(), to: i.Point(), angle: 0 }, background: function background(t, n, e, i) {\n      void 0 === i && (i = 1), o.clearColor(t, n, e, i);\n    }, layer: function layer(t) {\n      var n = j.find(function (n) {\n        return n.z === t;\n      });return n || (n = new e(t), j.push(n), j.sort(function (t, n) {\n        return n.z - t.z;\n      })), n;\n    }, add: function add(t) {\n      A.add(t);\n    }, render: function render() {\n      var n = t.clientWidth,\n          e = t.clientHeight;t.width = n, t.height = e;var i = F.camera,\n          r = i.at,\n          s = i.to,\n          u = i.angle,\n          h = r.x - n * s.x,\n          f = r.y - e * s.y,\n          l = Math.cos(u),\n          v = Math.sin(u),\n          p = 2 / n,\n          x = -2 / e,\n          b = [l * p, v * x, 0, 0, -v * p, l * x, 0, 0, 0, 0, -1e-5, 0, (r.x * (1 - l) + r.y * v) * p - 2 * h / n - 1, (r.y * (1 - l) - r.x * v) * x + 2 * f / e + 1, 0, 1];o.useProgram(c), o.uniformMatrix4fv(g, !1, b), o.viewport(0, 0, n, e), o.clear(16640), o.activeTexture(33984), y = null, o.disable(3042), o.enable(2929), o.depthFunc(513), d = !0, j.forEach(function (t) {\n        return t.o.i(function (t) {\n          return z(t);\n        });\n      }), P(), o.enable(3042), o.blendFunc(a, 771), o.depthFunc(515), o.uniform1f(m, 0), d = !1;for (var w = j.length - 1; w >= 0; w--) {\n        j[w].t.i(function (t) {\n          return z(t);\n        });\n      }P();\n    } };return F.render(), F;\n};i.Point = function () {\n  function t(t, n) {\n    if (!(this instanceof i.Point)) return new i.Point(t, n);this.set(t, n);\n  }return t.prototype.set = function (t, n) {\n    return this.x = t || 0, this.y = n || (0 !== n ? this.x : 0), this;\n  }, t.prototype.copy = function (t) {\n    return this.x = t.x, this.y = t.y, this;\n  }, t;\n}();var r = function t(n, e, r, a) {\n  if (!(this instanceof t)) return new t(n, e, r, a);this.size = i.Point().copy(r), this.anchor = i.Point().copy(a || n.anchor), this.uvs = [e.x / n.size.x, e.y / n.size.y, r.x / n.size.x, r.y / n.size.y], this.t = n;\n},\n    a = { atest: { configurable: !0 }, tex: { configurable: !0 } };a.atest.get = function () {\n  return this.t.atest;\n}, a.tex.get = function () {\n  return this.t.tex;\n}, Object.defineProperties(r.prototype, a);i.Frame = r, i.Texture = function t(n, e, r, a) {\n  if (!(this instanceof t)) return new t(n, e, r, a);this.size = i.Point(e.width, e.height), this.anchor = i.Point(), this.uvs = [0, 0, 1, 1], this.atest = r || (0 === r ? 0 : 1);var o = _extends({ 10240: 9728, 10241: 9728, 10242: 33071, 10243: 33071 }, a),\n      s = n.gl;this.tex = s.createTexture(), s.bindTexture(3553, this.tex), Object.keys(o).forEach(function (t) {\n    return s.texParameteri(3553, t, o[t]);\n  }), s.texImage2D(3553, 0, 6408, 6408, 5121, e);\n}, i.Sprite = function () {\n  function t(n, e) {\n    if (!(this instanceof t)) return new t(n, e);this.frame = n, this.a = 1, _extends(this, { visible: !0, position: i.Point(), rotation: 0, anchor: null, scale: i.Point(1), tint: 16777215 }, e), this.remove();\n  }var n = { alpha: { configurable: !0 } };return n.alpha.get = function () {\n    return this.a;\n  }, n.alpha.set = function (t) {\n    var n = this.a;this.a = t, this.n && (t < 1 && 1 === n || 1 === t && n < 1) && this.layer.add(this);\n  }, t.prototype.remove = function () {\n    this.n && this.n.r(), this.layer = null, this.n = null;\n  }, Object.defineProperties(t.prototype, n), t;\n}();exports.default = i;\n\n/***/ }),\n\n/***/ \"ZAL5\":\n/***/ (function(module, exports) {\n\n// removed by extract-text-webpack-plugin\nmodule.exports = {\"home\":\"home__2Q5nZ\"};\n\n/***/ })\n\n});\n\n\n// WEBPACK FOOTER //\n// route-home.chunk.fb2b2.js","/* eslint-disable new-cap */\nimport { h, Component } from 'preact';\nimport Renderer from 'js13k-2d';\nimport style from './style';\n\nconst { Point, Texture, Frame, Sprite } = Renderer;\n\n/*\nconst sprites = document.getElementById('info');\n\nconst dbgRenderInfo = gl.getExtension('WEBGL_debug_renderer_info');\nconst info = gl.getParameter(\n    dbgRenderInfo ? dbgRenderInfo.UNMASKED_RENDERER_WEBGL : gl.VENDOR\n);\n*/\n\nconst atlasImg = () => {\n    const canvas = document.createElement('canvas');\n    const size = 32;\n    const half = size / 2;\n    canvas.width = 96;\n    canvas.height = 32;\n    const ctx = canvas.getContext('2d');\n\n    let offset = 0;\n\n    ctx.lineWidth = size / 16;\n    ctx.fillStyle = '#cccccc';\n    ctx.strokeStyle = '#000000';\n    ctx.beginPath();\n\n    ctx.moveTo(offset + half, half);\n    for (let angle = 0; angle < Math.PI * 2; angle += (Math.PI * 2) / 5) {\n        ctx.lineTo(\n            offset + half - Math.sin(angle) * half * 0.9,\n            half - Math.cos(angle) * half * 0.9\n        );\n    }\n\n    ctx.closePath();\n    ctx.fill();\n    ctx.stroke();\n\n    offset += size;\n\n    ctx.beginPath();\n\n    ctx.moveTo(offset + 3, 3);\n    ctx.lineTo(offset + size - 3, 3);\n    ctx.lineTo(offset + size - 3, size - 3);\n    ctx.lineTo(offset + 3, size - 3);\n\n    ctx.closePath();\n    ctx.fill();\n    ctx.stroke();\n\n    offset += size;\n\n    ctx.beginPath();\n\n    ctx.moveTo(offset + 3, 3);\n    ctx.lineTo(offset + 29, 3);\n    ctx.lineTo(offset + 29, 8);\n    ctx.lineTo(offset + 8, 8);\n    ctx.lineTo(offset + 8, 14);\n    ctx.lineTo(offset + 20, 14);\n    ctx.lineTo(offset + 20, 18);\n    ctx.lineTo(offset + 8, 18);\n    ctx.lineTo(offset + 8, 29);\n    ctx.lineTo(offset + 3, 29);\n\n    ctx.closePath();\n    ctx.fill();\n    ctx.stroke();\n\n    return canvas;\n};\n\nexport default class Home extends Component {\n    onmousedown = event => {\n        this.add = true;\n        event.preventDefault();\n    };\n\n    ontouchstart = event => {\n        this.add = true;\n        event.preventDefault();\n    };\n\n    onmouseup = event => {\n        this.add = false;\n        event.preventDefault();\n    };\n\n    ontouchend = event => {\n        this.add = false;\n        event.preventDefault();\n    };\n\n    componentDidMount() {\n        const view = document.getElementById('view');\n\n        this.add = false;\n\n        /*\n        let add = false;\n        view.onmousedown = event => {\n            event.preventDefault();\n            add = true;\n        };\n        view.ontouchstart = event => {\n            add = true;\n            event.preventDefault();\n        };\n        view.onmouseup = event => {\n            add = false;\n            event.preventDefault();\n        };\n        view.ontouchend = event => {\n            add = false;\n            event.preventDefault();\n        };\n        */\n\n        const scene = Renderer(view);\n        const { gl } = scene;\n\n        const maskSize = Math.min(\n            scene.gl.canvas.width,\n            scene.gl.canvas.height\n        );\n\n        scene.background(1, 1, 1, 0);\n        scene.camera.at.set(maskSize / 2, maskSize / 2);\n        scene.camera.to.set(0.5);\n\n        const logoMask = () => {\n            const canvas = document.createElement('canvas');\n            canvas.width = maskSize;\n            canvas.height = maskSize;\n            const ctx = canvas.getContext('2d');\n\n            ctx.fillStyle = '#ffffff';\n            ctx.beginPath();\n\n            ctx.moveTo(maskSize / 2, maskSize / 2);\n            for (\n                let angle = 0;\n                angle < Math.PI * 2;\n                angle += (Math.PI * 2) / 5\n            ) {\n                ctx.lineTo(\n                    maskSize / 2 - (Math.sin(angle) * maskSize) / 2.5,\n                    maskSize / 2 - (Math.cos(angle) * maskSize) / 2.5\n                );\n            }\n\n            ctx.closePath();\n            ctx.fill();\n\n            const { data } = ctx.getImageData(0, 0, maskSize, maskSize);\n\n            return (x, y) => data[(y * maskSize + x) * 4] > 0;\n        };\n\n        /*\n        const logo = () => {\n            const canvas = document.createElement('canvas');\n            canvas.width = 64;\n            canvas.height = 64;\n            const ctx = canvas.getContext('2d');\n\n            ctx.lineWidth = 0;\n            ctx.strokeStyle = '#3066a9';\n            ctx.fillStyle = '#3066a9';\n            ctx.beginPath();\n\n            ctx.moveTo(32, 32);\n            for (\n                let angle = 0;\n                angle < Math.PI * 2;\n                angle += (Math.PI * 2) / 5\n            ) {\n                ctx.lineTo(\n                    32 - Math.sin(angle) * 30,\n                    32 - Math.cos(angle) * 30\n                );\n            }\n\n            ctx.closePath();\n            ctx.stroke();\n            ctx.fill();\n\n            const image = new Image();\n            image.src = canvas.toDataURL('image/png');\n            document.body.appendChild(image);\n        };\n\n        logo();\n        */\n\n        const atlas = Texture(scene, atlasImg(), 0.5, {\n            [gl.TEXTURE_MAG_FILTER]: gl.LINEAR,\n            [gl.TEXTURE_MIN_FILTER]: gl.LINEAR,\n        });\n        atlas.anchor = Point(0.5);\n\n        const bFrame = Frame(atlas, Point(), Point(32));\n        const qFrame = Frame(atlas, Point(32, 0), Point(32));\n        const fFrame = Frame(atlas, Point(64, 0), Point(32));\n        const frames = [atlas, bFrame, qFrame, fFrame];\n\n        const mask = logoMask();\n        const sprs = [];\n\n        let len = 0;\n        let cl = 0;\n\n        const addSprite = a => {\n            if (len % 250 === 0) {\n                cl++;\n            }\n            len += a;\n\n            const layer = scene.layer(cl);\n\n            for (let i = 0; i < a; i++) {\n                const sprite = Sprite(frames[i % 4]);\n\n                let x = 0;\n                let y = 0;\n\n                while (!mask(x, y)) {\n                    x = ~~(maskSize * Math.random());\n                    y = ~~(maskSize * Math.random());\n                }\n\n                sprite.position.set(x, y);\n                sprite.scale.set(maskSize / 1200);\n                sprite.tint = Math.random() * 0xffffff;\n                sprite.rotation = Math.random() * Math.PI * 2;\n                sprite.dr = (0.5 - Math.random()) * 0.1;\n                sprite.trans = !Math.round(Math.random());\n                // sprite.trans = false;\n                sprs.push(sprite);\n                layer.add(sprite);\n            }\n        };\n\n        const loop = () => {\n            if (len < 3000 || this.add) addSprite(25);\n\n            // sprites.innerHTML = `Renderer: ${info}</br>Sprites: ${len} (click to add)`;\n\n            sprs.forEach(sprite => {\n                sprite.dr && (sprite.rotation += sprite.dr);\n                if (sprite.trans) {\n                    if (sprite.alpha > 0.8) {\n                        sprite.alpha -= 0.001;\n                    } else {\n                        sprite.trans = false;\n                    }\n                }\n            });\n\n            scene.camera.angle += 0.005;\n\n            scene.render();\n\n            return [\n                {\n                    title: 'sprites',\n                    value: len < 10000 ? len : `${(len / 1000).toFixed(1)}k`,\n                },\n            ];\n        };\n\n        this.props.start(loop);\n    }\n\n    /*\n                <h1>Home</h1>\n                <p>This is the Home component.</p>\n    */\n\n    render() {\n        return (\n            <div\n                class={style.home}\n                onMouseDown={this.onmousedown}\n                onTouchStart={this.ontouchstart}\n                onMouseUp={this.onmouseup}\n                onTouchEnd={this.ontouchend}\n            >\n                Click or touch to add sprites\n                <canvas id=\"view\" />\n            </div>\n        );\n    }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./routes/home/index.js","var t=function(t,n){this.c=t,this.p=null,this.n=n,this.d=0};t.prototype.r=function(){this.d=1};var n=function(){this.h=null};n.prototype.add=function(n){var e=new t(n,this.h);return this.h&&(this.h.p=e),this.h=e,e},n.prototype.i=function(t){for(var n=this.h;n;)n.d?(n.p?n.p.n=n.n:this.h=n.n,n.n&&(n.n.p=n.p)):t(n.c),n=n.n};var e=function(t){this.z=t,this.o=new n,this.t=new n};e.prototype.add=function(t){t.remove(),t.layer=this,t.n=(function(t){return 1!==t.alpha||0===t.frame.atest}(t)?this.t:this.o).add(t)};var i=function(t,n){var r=Object.assign({antialias:!1,alpha:!1},n),a=r.alpha?1:770,o=t.getContext(\"webgl\",r),s=o.getExtension(\"ANGLE_instanced_arrays\"),u=function(t,n){var e=o.createShader(n);return o.shaderSource(e,t),o.compileShader(e),e},c=o.createProgram();o.attachShader(c,u(\"attribute vec2 g;\\nattribute vec2 a;\\nattribute vec2 t;\\nattribute float r;\\nattribute vec2 s;\\nattribute vec4 u;\\nattribute vec4 c;\\nattribute float z;\\nuniform mat4 m;\\nvarying vec2 v;\\nvarying vec4 i;\\nvoid main(){\\nv=u.xy+g*u.zw;\\ni=c.abgr;\\nvec2 p=(g-a)*s;\\nfloat q=cos(r);\\nfloat w=sin(r);\\np=vec2(p.x*q-p.y*w,p.x*w+p.y*q);\\np+=a+t;\\ngl_Position=m*vec4(p,z,1);}\",35633)),o.attachShader(c,u(\"precision mediump float;\\nuniform sampler2D x;\\nuniform float j;\\nvarying vec2 v;\\nvarying vec4 i;\\nvoid main(){\\nvec4 c=texture2D(x,v);\\ngl_FragColor=c*i;\\nif(j>0.0){\\nif(c.a<j)discard;\\ngl_FragColor.a=1.0;};}\",35632)),o.linkProgram(c);var h=function(t,n,e){var i=o.createBuffer();return o.bindBuffer(t,i),o.bufferData(t,n,e||35044),i},f=function(t,n,e,i,r,a,u){var h=o.getAttribLocation(c,t);return o.enableVertexAttribArray(h),o.vertexAttribPointer(h,n,a||5126,!!u,e||0,r||0),i&&s.vertexAttribDivisorANGLE(h,i),h};h(34963,new Uint8Array([0,1,2,2,1,3])),h(34962,new Float32Array([0,0,0,1,1,0,1,1])),f(\"g\",2);var l=new ArrayBuffer(3407820),v=new Float32Array(l),p=new Uint32Array(l);h(34962,l,35048),f(\"a\",2,52,1),f(\"s\",2,52,1,8),f(\"r\",1,52,1,16),f(\"t\",2,52,1,20),f(\"u\",4,52,1,28),f(\"c\",4,52,1,44,5121,!0),f(\"z\",1,52,1,48);var y,d,x=function(t){return o.getUniformLocation(c,t)},g=x(\"m\"),b=x(\"x\"),m=x(\"j\"),w=0,P=function(){w&&(o.bufferSubData(34962,0,v.subarray(0,13*w)),s.drawElementsInstancedANGLE(4,6,5121,0,w),w=0)},z=function(t){if(t.visible){65535===w&&P();var n=t.frame,e=t.scale,i=t.position,r=n.tex,a=n.size,s=n.uvs,u=t.anchor||n.anchor;y!==r&&(P(),y=r,o.bindTexture(3553,r),o.uniform1i(b,r),o.uniform1f(m,d?n.atest:0));var c=13*w;v[c++]=u.x,v[c++]=u.y,v[c++]=e.x*a.x,v[c++]=e.y*a.y,v[c++]=t.rotation,v[c++]=i.x,v[c++]=i.y,v[c++]=s[0],v[c++]=s[1],v[c++]=s[2],v[c++]=s[3],p[c++]=((16777215&t.tint)<<8|255*t.alpha&255)>>>0,v[c++]=t.layer.z,w++}},A=new e(0),j=[A],F={gl:o,camera:{at:i.Point(),to:i.Point(),angle:0},background:function(t,n,e,i){void 0===i&&(i=1),o.clearColor(t,n,e,i)},layer:function(t){var n=j.find(function(n){return n.z===t});return n||(n=new e(t),j.push(n),j.sort(function(t,n){return n.z-t.z})),n},add:function(t){A.add(t)},render:function(){var n=t.clientWidth,e=t.clientHeight;t.width=n,t.height=e;var i=F.camera,r=i.at,s=i.to,u=i.angle,h=r.x-n*s.x,f=r.y-e*s.y,l=Math.cos(u),v=Math.sin(u),p=2/n,x=-2/e,b=[l*p,v*x,0,0,-v*p,l*x,0,0,0,0,-1e-5,0,(r.x*(1-l)+r.y*v)*p-2*h/n-1,(r.y*(1-l)-r.x*v)*x+2*f/e+1,0,1];o.useProgram(c),o.uniformMatrix4fv(g,!1,b),o.viewport(0,0,n,e),o.clear(16640),o.activeTexture(33984),y=null,o.disable(3042),o.enable(2929),o.depthFunc(513),d=!0,j.forEach(function(t){return t.o.i(function(t){return z(t)})}),P(),o.enable(3042),o.blendFunc(a,771),o.depthFunc(515),o.uniform1f(m,0),d=!1;for(var w=j.length-1;w>=0;w--)j[w].t.i(function(t){return z(t)});P()}};return F.render(),F};i.Point=function(){function t(t,n){if(!(this instanceof i.Point))return new i.Point(t,n);this.set(t,n)}return t.prototype.set=function(t,n){return this.x=t||0,this.y=n||(0!==n?this.x:0),this},t.prototype.copy=function(t){return this.x=t.x,this.y=t.y,this},t}();var r=function t(n,e,r,a){if(!(this instanceof t))return new t(n,e,r,a);this.size=i.Point().copy(r),this.anchor=i.Point().copy(a||n.anchor),this.uvs=[e.x/n.size.x,e.y/n.size.y,r.x/n.size.x,r.y/n.size.y],this.t=n},a={atest:{configurable:!0},tex:{configurable:!0}};a.atest.get=function(){return this.t.atest},a.tex.get=function(){return this.t.tex},Object.defineProperties(r.prototype,a);i.Frame=r,i.Texture=function t(n,e,r,a){if(!(this instanceof t))return new t(n,e,r,a);this.size=i.Point(e.width,e.height),this.anchor=i.Point(),this.uvs=[0,0,1,1],this.atest=r||(0===r?0:1);var o=Object.assign({10240:9728,10241:9728,10242:33071,10243:33071},a),s=n.gl;this.tex=s.createTexture(),s.bindTexture(3553,this.tex),Object.keys(o).forEach(function(t){return s.texParameteri(3553,t,o[t])}),s.texImage2D(3553,0,6408,6408,5121,e)},i.Sprite=function(){function t(n,e){if(!(this instanceof t))return new t(n,e);this.frame=n,this.a=1,Object.assign(this,{visible:!0,position:i.Point(),rotation:0,anchor:null,scale:i.Point(1),tint:16777215},e),this.remove()}var n={alpha:{configurable:!0}};return n.alpha.get=function(){return this.a},n.alpha.set=function(t){var n=this.a;this.a=t,this.n&&(t<1&&1===n||1===t&&n<1)&&this.layer.add(this)},t.prototype.remove=function(){this.n&&this.n.r(),this.layer=null,this.n=null},Object.defineProperties(t.prototype,n),t}();export default i;\n\n\n\n// WEBPACK FOOTER //\n// ../node_modules/js13k-2d/dist/renderer.m.js","// removed by extract-text-webpack-plugin\nmodule.exports = {\"home\":\"home__2Q5nZ\"};\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./routes/home/style.css\n// module id = ZAL5\n// module chunks = 0"],"sourceRoot":""}